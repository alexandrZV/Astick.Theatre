"use strict";!function(n){n.extend(n.fn.mdlTable.defaults,{editable:!1,editableAutoEdit:!0,onEditableInit:function(){return!1},onEditableSave:function(){return!1},onEditableShown:function(){return!1},onEditableHidden:function(){return!1}});n.extend(n.fn.mdlTable.Constructor.EVENTS,{"editable-init.mdl.table":"onEditableInit","editable-save.mdl.table":"onEditableSave","editable-shown.mdl.table":"onEditableShown","editable-hidden.mdl.table":"onEditableHidden"});var t=n.fn.mdlTable.Constructor,u=t.prototype.f_InitHeader,r=t.prototype.f_GetBtnEdit,f=t.prototype.f_InitBody,e=t.prototype.f_UpdateRow,i=t.prototype.f_GetValue;t.prototype.f_InitHeader=function(){var t=this;t.options.editable&&n.each(this.columns,function(n,i){i.editable&&(t.m_CardView?i.formatter=null:(i.formatter=i.formatter||function(n){return n},i._formatter=i._formatter?i._formatter:i.formatter,i.formatter=function(n,r,u){var l=i._formatter?i._formatter(n,r,u):n,f="",h,c,v;i.valRequired&&(f=" required");i.valRegexPattern!=null?(f+=' pattern="'+i.valRegexPattern+'"',i.valRegexMsg!=null&&(f+=' patternmsg="'+i.valRegexMsg+'"')):i.type=="int"?f+=' pattarn="-?[0-9]*(.[0-9]+)?"':i.type=="uint"&&(f+=' pattarn="^d+$"');var a="text",e="",o="",s="";return(i.type=="number"||i.type=="int"||i.type=="uint")&&(a="number",i.fieldMin!=null?(h=r[i.fieldMin],e=' min="'+h+'" minlength="'+h+'"'):i.min!=null&&(e=' min="'+i.min+'" minlength="'+i.min+'"'),i.fieldMax!=null?(c=r[i.fieldMax],o=' max="'+c+'" maxlength="'+c+'"'):i.max!=null&&(o=' max="'+i.max+'" maxlength="'+i.max+'"'),i.fieldStep!=null?(v=r[i.fieldStep],s=' step="'+v+'"'):i.step!=null&&(s=' step="'+i.step+'"')),['<input type="'+a+'"'+e+o+s+' class="editable"',' data-field="'+i.field+'"',' data-key="'+r[t.options.key]+'"',' data-val="'+l+'"',' value="'+l+'"',f," />"].join("")}))});u.apply(this,Array.prototype.slice.apply(arguments))};t.prototype.f_GetCardShowEditing=function(){if(this.m_CardView)for(var n=0;n<this.columns.length;n++)if(this.columns[n].editable)return this;return!1};t.prototype.f_GetValue=function(n,t,r,u,f,e){var s,o,h,c;return u?i.apply(this,Array.prototype.slice.apply(arguments)):(s=e,s==null&&(s=f!=null?f:this.data[n]),this.options.editingField==null||s[this.options.editingField]?i.apply(this,Array.prototype.slice.apply(arguments)):(o=this.f_GetColumn(t),o!=null&&o.editable?(h=this.header.formatters[o.fieldIndex],this.header.formatters[o.fieldIndex]=null,c=i.apply(this,Array.prototype.slice.apply(arguments)),this.header.formatters[o.fieldIndex]=h,c):i.apply(this,Array.prototype.slice.apply(arguments))))};t.prototype.f_GetBtnEdit=function(){var n,t;return this.options.showEdit?r.apply(this,Array.prototype.slice.apply(arguments)):this.f_GetCardShowEditing()?(n=this.options.showEdit,this.options.showEdit=!0,t=r.apply(this,Array.prototype.slice.apply(arguments)),this.options.showEdit=n,t):""};t.prototype.f_InitInputsEdit=function(){var t=this,i=function(i,r){var u=t.f_GetRowData(i),f=r.getAttribute("data-field"),e=u[f],o;e.toString()!=r.value&&(o=t.f_GetColumn(f),u[f]=o.type=="int"||o.type=="uint"||o.type=="number"?parseInt(r.value):r.value,t.options.editableAutoEdit?t.options.editAction!=null?(calculateObjectValue(null,t.options.editAction,[t,u],""),t.f_Trigger("editable-save",t,f,t.f_GetRowIndex(i),u,e)):n.ajax({type:t.options.editMethod,url:t.options.editUrl,data:u,success:function(){t.f_Trigger("editable-save",t,f,t.f_GetRowIndex(i),u,e);t.f_Refresh()}}):t.f_Trigger("editable-save",t,f,t.f_GetRowIndex(i),u,e))};this.$el.find(" > tbody > tr.mdl-table_row input.editable").off("blur").on("blur",function(n){this.getAttribute("pattern")!=null&&this.getAttribute("patternmsg")!=null?this.value.search(new RegExp(this.getAttribute("pattern")))>=0?i(n,this):this.value=this.getAttribute("data-val"):this.checkValidity()?i(n,this):this.value=this.getAttribute("data-val")}).off("keyup").on("keyup",function(n){this.getAttribute("pattern")!=null&&this.getAttribute("patternmsg")!=null&&(this.value.search(new RegExp(this.getAttribute("pattern")))>=0?this.setCustomValidity(""):this.setCustomValidity(this.getAttribute("patternmsg")));n.keyCode==13?this.reportValidity()&&i(n,this):n.keyCode==27&&(this.value=this.getAttribute("data-val"))})};t.prototype.f_InitBody=function(){f.apply(this,Array.prototype.slice.apply(arguments));this.f_InitInputsEdit()};t.prototype.f_UpdateRow=function(){e.apply(this,Array.prototype.slice.apply(arguments));this.f_InitInputsEdit()}}(jQuery);