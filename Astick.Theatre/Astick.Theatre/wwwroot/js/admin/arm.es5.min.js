"use strict";function Cl_ARM(){this.p_ARMTitle="";this.p_IsDateStart=this.p_IsDateStart===!0;Cl_BaseEvents.call(this);this.p_ARMDateStart=null;this.p_IsInit=!1;this.e_Init=this.f_AddEvent("e_Init");this.e_ChangeARMDateStart=this.f_AddEvent("e_ChangeARMDateStart");var n=this;moment.locale("ru");this.p_IsDateStart&&(this.p_ARMDateStart=$.cookie("m_ARMDateStart"),this.p_ARMDateStart==null&&(this.p_ARMDateStart=moment().subtract(14,"days").format("DD.MM.YYYY"),$.cookie("m_ARMDateStart",this.p_ARMDateStart)))}function f_SetTitle(n){var t=n;(t==null||t=="")&&(t=document.querySelector(".pageTitle").outerText);document.title=p_Title+" - "+t}function f_ChangeContent(n){var r=new CustomEvent("changingPageContent",{bubbles:!0,cancelable:!0,detail:{a_Element:el_ARMPageContent,a_NewContent:n}}),t,i;document.documentElement.dispatchEvent(r);t=$(el_ARMPageContent).html(n);componentHandler.upgradeElements(t[0]);i=new CustomEvent("changedPageContent",{bubbles:!0,cancelable:!0,detail:{a_Element:el_ARMPageContent}});document.documentElement.dispatchEvent(i);f_SetTitle()}function f_AJAXLoadHref(){f_ShowLoading();$.ajax({headers:{"X-Requested-With":"XMLHttpRequest"},type:"GET",url:window.location.href,contentType:"application/json; charset=utf-8",success:function(n){f_HideLoading();this.dataTypes[1]!="script"&&f_ChangeContent(n)}})}function f_IsMobile(){return $(window).width()<=839}function f_ShowLoading(n){if(f_IsMobile())$(".lMobileMain").addClass("active");else{var t;t=n!=null?n:"#arm-content";$(t).waitMe()}}function f_HideLoading(n){$(".lMobileMain").removeClass("active");var t;t=n!=null?n:"#arm-content";$(t).waitMe("hide")}function f_GoLink(n,t){f_ShowLoading();$.ajax({method:"GET",url:n,data:t,cache:!1,success:function(n){var r=$(el_ARMPageContent).html(n),t,i;componentHandler.upgradeElements(r[0]);t=document.querySelector(".pageUrl").outerText.replace(/&amp;/g,"&");history.pushState&&window.history.pushState("ajax",document.title,t);f_SetTitle();i=new CustomEvent("changedPageContent",{bubbles:!0,cancelable:!0,detail:{a_Element:el_ARMPageContent,a_Content:n}});document.documentElement.dispatchEvent(i);f_HideLoading();f_TopMenuClose()}})}function f_MenuSelectItem(n){var t=n.getAttribute("data-url");n.getAttribute("data-target")=="blank"?window.open(t,"_blank"):f_GoLink(t)}function f_TopMenuInitUser(){el_ARMHeaderLeftMenu.querySelector(".userName").innerText=m_User.p_Name;el_ARMHeaderLeftMenu.querySelector(".userMobile").innerText=m_User.p_Mobile;el_ARMHeaderLeftMenu.querySelector(".userEmail").innerText=m_User.p_Email;el_ARMHeaderLeftMenu.querySelector(".userOffice").innerHTML=m_User.p_OfficeName}function f_TopMenuRefresh(){$.post("/arm/f_GetUser",function(n){n.error===undefined?(m_User=n,f_TopMenuInitUser()):alert(n.error)})}function f_TopMenuClose(){var n=document.getElementById("topmenu").MaterialLayout;f_Mdl_LayoutMenuClose(n)}function f_ChangeSkin(n){return document.body.className="",document.body.classList.add(n),$.cookie("skin",n),!1}var p_Title="ASTICK",el_ARMTitle,ARMTitleBase,el_ARMPageContent,el_ARMHeaderLeftMenu;Cl_ARM.prototype.f_Init=function(){if(this.p_IsDateStart){var t=this,n=document.getElementById("menu_dateStart");n.classList.remove("hidden");this.elMdlMenuDateStart=n.querySelector(".mdl-datefield");componentHandler.upgradeElement(this.elMdlMenuDateStart,"MaterialDatefield");this.elMdlMenuDateStart=this.elMdlMenuDateStart.MaterialDatefield;this.elMdlMenuDateStart.element.onchange=function(){t.f_SetARMDateStart(this.value)};this.elMdlMenuDateStart.f_SetDate(this.p_ARMDateStart)}this.p_IsInit=!0;this.e_Init()};Cl_ARM.prototype.f_SetARMDateStart=function(n){return n!=null&&moment(n,"DD MMM YYYY").isValid()?($.cookie("m_ARMDateStart",n),this.p_ARMDateStart=n,this.elMdlMenuDateStart.element.value!==n&&this.elMdlMenuDateStart.f_SetDate(n),this.e_ChangeARMDateStart(),!0):!1};Cl_ARM.prototype.f_SetTitle=function(n){var t=n;(t==null||t=="")&&(t=document.querySelector(".pageTitle").outerText);this.p_ARMTitle!=null&&this.p_ARMTitle!=""?(document.title=window.m_MailCounters!==undefined?this.p_ARMTitle+"("+m_MailCounters+"). "+t:this.p_ARMTitle+". "+t,el_ARMTitle.innerText=this.p_ARMTitle+". "+t):(f_SetTitle(t),el_ARMTitle.innerText=t)};document.addEventListener("DOMContentLoaded",function(){var n,t,i,r;el_ARMTitle=document.querySelector("#arm-title");ARMTitleBase=el_ARMTitle.outerText;el_ARMPageContent=document.querySelector("#arm-content");el_ARMHeaderLeftMenu=document.querySelector(".leftMenu_header");f_TopMenuInitUser();n=document.querySelector(".rightMenu");n.addEventListener("click",function(n){n.stopPropagation()});t=n.querySelector(".mdl-tabs");i=n.querySelectorAll(".mdl-tabs__tab");[].forEach.call(i,function(i){i.addEventListener("click",function(){var r=t.MaterialTabs,u=i.href.split("#")[1],f=r.element_.querySelector("#"+u);r.resetTabState_();r.resetPanelState_();i.classList.add(r.CssClasses_.ACTIVE_CLASS);f.classList.add(r.CssClasses_.ACTIVE_CLASS);n.MaterialMenu.show()})});el_ARMTitle.innerText=document.querySelector(".pageTitle").outerText;document.addEventListener("changedPageContent",function(){el_ARMTitle.innerText=document.querySelector(".pageTitle").outerText});window.addEventListener("popstate",function(n){window.history.m_Blocking!=!0&&(n.state=="ajax"?f_AJAXLoadHref():(n.state==null||n.state=="")&&window.history.replaceState("ajax",document.title,window.location.href));n.preventDefault()},!1);f_SetTitle();f_ChangeSkin($.cookie("skin"));r=document.querySelectorAll("[data-skin]");[].forEach.call(r,function(n){n.addEventListener("click",function(n){n.preventDefault();f_ChangeSkin(this.getAttribute("data-skin"))})})});